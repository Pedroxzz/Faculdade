--CRIAR BANCO DE DADOS
CREATE DATABASE LOJA_2
--USAR O BANCO
USE LOJA_2
--CRIAR A TABELA 
CREATE TABLE PRODUTOS_2
(NM_PRODUTO VARCHAR (80) NOT NULL,
DT_COMPRA DATE NOT NULL,
QT_ESTOQUE INT,
QT_MINIMA INT,
VL_PRECO NUMERIC(18,2))

INSERT INTO PRODUTOS_2 (NM_PRODUTO, DT_COMPRA, QT_ESTOQUE,
QT_MINIMA, VL_PRECO) VALUES
('Produto A', '2024-01-15 10:00:00', 120, 10, 19.99),
('Produto B', '2024-02-22 11:30:00', 200, 25, 49.50),
('Produto C', '2024-03-10 14:45:00', 75, 5, 9.99),
('Produto D', '2024-04-05 09:00:00', 50, 10, 12.75),
('Produto E', '2024-05-20 16:15:00', 30, 15, 89.99),
('Produto F', '2024-06-25 13:00:00', 100, 20, 24.90),
('Produto G', '2024-07-30 10:30:00', 45, 8, 34.50),
('Produto H', '2024-08-18 12:00:00', 150, 30, 14.95),
('Produto I', '2024-09-12 15:45:00', 60, 12, 59.99),
('Produto J', '2024-10-08 11:15:00', 90, 20, 27.80),
('Produto K', '2024-11-14 10:00:00', 85, 5, 39.50),
('Produto L', '2024-12-20 13:30:00', 40, 10, 22.00),
('Produto M', '2024-01-10 14:00:00', 70, 15, 78.99),
('Produto N', '2024-02-25 09:30:00', 55, 8, 47.20),
('Produto O', '2024-03-15 11:00:00', 120, 25, 33.75),
('Produto P', '2024-04-22 12:15:00', 90, 20, 26.30),
('Produto Q', '2024-05-18 10:45:00', 80, 10, 53.50),
('Produto R', '2024-06-12 13:30:00', 30, 5, 11.90),
('Produto S', '2024-07-28 16:00:00', 100, 15, 66.99),
('Produto T', '2024-08-16 10:15:00', 65, 20, 37.00),
('Produto U', '2024-09-22 14:30:00', 75, 12, 25.60),
('Produto V', '2024-10-10 13:45:00', 85, 10, 18.45),
('Produto W', '2024-11-05 11:00:00', 40, 8, 90.00),
('Produto X', '2024-12-15 15:30:00', 55, 20, 31.70),
('Produto Y', '2024-01-20 09:45:00', 95, 10, 29.90),
('Produto Z', '2024-02-14 12:00:00', 70, 5, 75.50),
('Produto AA', '2024-03-30 10:15:00', 50, 20, 85.99),
('Produto BB', '2024-04-18 14:00:00', 110, 15, 41.80),
('Produto CC', '2024-05-12 16:30:00', 45, 10, 27.40),
('Produto DD', '2024-06-20 11:00:00', 80, 12, 17.25),
('Produto EE', '2024-07-15 09:30:00', 60, 8, 99.90),
('Produto FF', '2024-08-22 13:15:00', 125, 25, 23.00),
('Produto GG', '2024-09-18 15:45:00', 70, 5, 56.75),
('Produto HH', '2024-10-25 10:00:00', 50, 10, 44.00),
('Produto II', '2024-11-12 14:15:00', 90, 20, 18.90),
('Produto JJ', '2024-12-08 12:00:00', 110, 15, 62.50);

SELECT * FROM PRODUTOS_2

 --MOSTRAR (IMPRIMIR) TODOS OS PRODUTOS ORDENADOS PELO CAMPO 
-- QT_ESTOQUE.
SELECT * FROM PRODUTOS_2 ORDER BY QT_ESTOQUE

--MOSTRAR O PRODUTO QUE TEM O MAIOR ESTOQUE 
SELECT TOP 1 * FROM PRODUTOS_2 ORDER BY QT_ESTOQUE DESC

--MOSTRAR TODOS OS PRODUTOS E AS QUANTIDADES ESTOQUE - QTD MINIMA
SELECT NM_PRODUTO, QT_ESTOQUE, QT_MINIMA, (QT_ESTOQUE-QT_MINIMA)
AS DIFERENCA FROM PRODUTOS_2 

--IMPRIMIR TODOS OS PRODUTOS QUE TEM NO MOME O TEXTO 'DD'
SELECT * FROM PRODUTOS_2 WHERE NM_PRODUTO LIKE '%A%'

--MOSTRAR TODOS PRODUTOS QUE TENHAM O NOME COM O TEXTO '%A%' E 
-- A QUANTIDADE DE ESTOQUE MAIOR QUE 50
SELECT * FROM PRODUTOS_2 WHERE NM_PRODUTO LIKE '%A%' AND 
QT_ESTOQUE>150

-- CRIA UMA VARIAVEL PARA VER O VALOR TOTAL DE PRODUTOS NO ESTOQUE 
SELECT 
	NM_PRODUTO, 
	QT_ESTOQUE,
	VL_PRECO, 
	QT_ESTOQUE*VL_PRECO AS VL_ESTOQUE
FROM PRODUTOS_2
-- CRIA UMA VARIAVEL PARA VER O VALOR TOTAL DE PRODUTOS NO ESTOQUE, ORDENANDO PELA COLUNA 2, E QUANDO VALOR REPETIDO, PEGA A 3 EM ORDEM DECRES.
SELECT 
	NM_PRODUTO, 
	QT_ESTOQUE,
	VL_PRECO, 
	QT_ESTOQUE*VL_PRECO AS VL_ESTOQUE
FROM PRODUTOS_2
ORDER BY 2,3 DESC

--CRIANDO UMA VIEW
CREATE VIEW VW_ESTOQUE
AS
SELECT 
	NM_PRODUTO, 
	QT_ESTOQUE,
	VL_PRECO, 
	QT_ESTOQUE*VL_PRECO AS VL_ESTOQUE
FROM PRODUTOS_2



