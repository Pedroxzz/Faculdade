CREATE DATABASE ATIVIDADEA1

--DDL COLOCAR O BANCO EM USO
USE ATIVIDADEA1

--DDL CRIAR A TABELA COM REGRA DE PK E CAMPO ÚNICO
CREATE TABLE PRODUTO
(CD_PRODUTO INT IDENTITY(1,1) NOT NULL,
NM_PRODUTO VARCHAR(50) NOT NULL,
VL_PRECO NUMERIC(18,2) NOT NULL,
DT_COMPRA DATE NULL,
QT_ESTOQUE INT NULL,
QT_MINIMA INT NULL,
CONSTRAINT PK_PRODUTO PRIMARY KEY(CD_PRODUTO),
CONSTRAINT UNICO_NOME UNIQUE(NM_PRODUTO))

--DML INCLUIR DADOS
INSERT INTO PRODUTO VALUES ('FOGÃO BRASTEMP 4 BOCAS',1100,'01/02/2023',10,10)
INSERT INTO PRODUTO VALUES ('FOGÃO BRASTEMP 5 BOCAS',1300,'02/02/2023',17,10)
INSERT INTO PRODUTO VALUES ('FOGÃO ELETROLUZ 4 BOCAS',1000,'05/02/2023',15,10)
INSERT INTO PRODUTO VALUES ('FOGÃO ELETROLUZ 5 BOCAS',1110.50,'01/12/2022',11,10)
INSERT INTO PRODUTO VALUES ('NOTEBOOK DELL',1700,'11/09/2022',12,10)
INSERT INTO PRODUTO VALUES ('NOTEBOOK ACER',1100,'08/08/2022',20,10)
INSERT INTO PRODUTO VALUES ('NOTEBOOK HP',2600,'10/09/2022',10,10)
INSERT INTO PRODUTO VALUES ('CELULAR MOTOROLA',2000.50,'10/02/2022',14,10)
INSERT INTO PRODUTO VALUES ('CELULAR SAMSUNG',1990.50,'10/04/2022',13,10)
INSERT INTO PRODUTO VALUES ('CELULAR APPLE',13999,'25/05/2022',13,10)
INSERT INTO PRODUTO VALUES ('GELADEIRA BRASTEMP',2100,'01/02/2023',30,10)
INSERT INTO PRODUTO VALUES ('GELADEIRA ELETROLUZ',1900,'02/02/2023',37,10)
INSERT INTO PRODUTO VALUES ('ASPIRADOR DE PÓ ELETROLUZ',450,'11/05/2022',25,10)
INSERT INTO PRODUTO VALUES ('MICRO-ONDAS BRASTEMP',980.50,'01/12/2022',11,10)
INSERT INTO PRODUTO VALUES ('TV SAMSUNG 50 POLEGADAS',3100,'11/08/2022',42,10)
INSERT INTO PRODUTO VALUES ('LAVA ROUPA 5KG BRASTEMP',1780.90,'07/07/2022',27,10)
INSERT INTO PRODUTO VALUES ('LAVA LOUÇA BRASTEMP',2510,'08/07/2022',19,10)
INSERT INTO PRODUTO VALUES ('LIQUIDIFICADOR ARNO',750.50,'10/07/2022',33,10)
INSERT INTO PRODUTO VALUES ('DATA SHOW SAMSUNG',2980.50,'02/04/2022',23,10)
INSERT INTO PRODUTO VALUES ('AQUECEDOR ARNO',399,'21/10/2022',29,10)
INSERT INTO PRODUTO VALUES ('BATEDEIRA',350,'02/02/2021',13,11)
INSERT INTO PRODUTO VALUES ('FAQUEIRO 72 PEÇAS',290,'03/03/2022',20,10)
INSERT INTO PRODUTO VALUES ('FOGÃO ELÉTRICO ELETROLUZ',980,'04/04/2021',16,11)
INSERT INTO PRODUTO VALUES ('PANELA DE PRESSÃO ELÉTRICA',650.50,'05/05/2021',08,05)

-- INICIAL
SELECT * FROM PRODUTO

--USANDO A CLÁUSULA BETWEEN EXIBIR OS PRODUTOS COM PREÇO ENTRE 3000 E 6000 EM ORDEM DECRESCENTE DE PREÇO. 
SELECT * FROM PRODUTO
WHERE VL_PRECO BETWEEN 3000 AND 6000
ORDER BY VL_PRECO DESC;

--QUAL PRODUTO TEM PREÇO DIFERENTE DE 2100? 
SELECT NM_PRODUTO
FROM PRODUTO
WHERE VL_PRECO != 2100;

--QUAL PRODUTO TEM PREÇO MAIOR QUE 2100? 
SELECT NM_PRODUTO
FROM PRODUTO
WHERE VL_PRECO > 2100;

--QUAL PRODUTO CUSTA 2100? 
SELECT NM_PRODUTO
FROM PRODUTO
WHERE VL_PRECO = 2100;

--PESQUISAR OS DADOS DA TABELA DE PRODUTO E COLOCAR EM ORDEM DECRESCENTE DE PREÇO. 
SELECT * FROM PRODUTO
ORDER BY VL_PRECO DESC;

--QUAIS PRODUTOS TÊM PREÇO MAIOR IGUAL A 1990,50 E QUANTIDADE EM ESTOQUE IGUAL A 13 EM ORDEM DECRESCENTE DE DATA DE COMPRA.
SELECT * FROM PRODUTO WHERE VL_PRECO >= 1990.50 AND QT_ESTOQUE = 13 ORDER BY DT_COMPRA DESC

--PESQUISAR COM MELHOR PERFORMANCE TODOS OS ATRIBUTOS E DADOS DA TABELA PRODUTO. 
SELECT * FROM PRODUTO;

--QUAIS PRODUTOS TÊM PREÇO IGUAL A 1000 E 2000 EM ORDEM DE DATA DE COMPRA DECRESCENTE. 
SELECT NM_PRODUTO FROM PRODUTO WHERE VL_PRECO IN (1000, 2000) ORDER BY DT_COMPRA DESC

--O QUAIS PRODUTOS FORAM COMPRADO EM 08/08/2022, EM ORDEM DE PREÇO? 
SELECT * FROM PRODUTO
WHERE DT_COMPRA = '2022-08-08'
ORDER BY VL_PRECO ASC;

--LISTAR OS PRODUTOS COM QUANTIDADE EM ESTOQUE MENOR IGUAL A 30 E MAIOR IGUAL A 1O EM ORDEM ALFABÉTICA.
SELECT * FROM PRODUTO
WHERE QT_ESTOQUE <= 30 AND QT_ESTOQUE >= 10
ORDER BY NM_PRODUTO ASC;

--LISTAR O PRODUTOS COM QUANTIDADE EM ESTOQUE MAIOR QUE 15 EM ORDEM ALFABÉTICA. 
SELECT * FROM PRODUTO WHERE QT_ESTOQUE > 15 ORDER BY NM_PRODUTO ASC

--EXIBA OS DADOS COMPLETOS DO PRODUTO NOTEBOOK ACER. 
SELECT * FROM PRODUTO
WHERE NM_PRODUTO = 'NOTEBOOK ACER';

--QUAIS PRODUTOS TÊM PREÇO MAIOR IGUAL A 1000 E MENOR IGUAL A 5000 EM ORDEM ALFABÉTICA. 
SELECT * FROM PRODUTO
WHERE VL_PRECO >= 1000 AND VL_PRECO <= 5000
ORDER BY NM_PRODUTO ASC;

--EXIBIR OS PRODUTOS COM QUANTIDADE EM ESTOQUE MAIOR E IGUAL A 20 E MENOR IGUAL A 30 USANDO BETWEEN ORDENAR POR DATA DE COMPRA DECRESCENTE.
SELECT * FROM PRODUTO WHERE QT_ESTOQUE BETWEEN 20 AND 30 ORDER BY DT_COMPRA DESC

--EXIBIR OS PRODUTOS COM PREÇO IGUAL A 1000, 2600 E 2100 E QUANTIDADE EM ESTOQUE IGUAL A 30 EM ORDEM DECRESCENTE DE PREÇO.
SELECT * FROM PRODUTO
WHERE (VL_PRECO = 1000 OR VL_PRECO = 2600 OR VL_PRECO = 2100)
AND QT_ESTOQUE = 30
ORDER BY VL_PRECO DESC;

--QUAL PRODUTO TEM A PK IGUAL A 11?
SELECT *FROM PRODUTO WHERE CD_PRODUTO = 11;

--MOSTRE TODOS OS PRODUTOS MENOS O NOTEBOOK ACER. 
SELECT * FROM PRODUTO
WHERE NM_PRODUTO <> 'NOTEBOOK ACER';

--EXIBA OS DADOS COMPLETOS DO PRODUTO NOTEBOOK ACER. 
SELECT * FROM PRODUTO
WHERE NM_PRODUTO = 'NOTEBOOK ACER';

--O PRODUTO MAIS CARO TEM PREÇO IGUAL A 13999 QUE PRODUTO É ESSE? 
SELECT * FROM PRODUTO WHERE VL_PRECO = 13999

--MOSTAR OS PRODUTOS COM PREÇO ORIGINAL, VALOR DO DESCONTO E VALOR FINAL COM O DESCONTO CALCULADO EM ORDEM ALFABÉTICA.
SELECT 
    NM_PRODUTO,
    VL_PRECO AS PREÇO_ORIGINAL,
    VL_PRECO * 0.05 AS VALOR_DO_DESCONTO,  
    VL_PRECO - (VL_PRECO * 0.05) AS VALOR_FINAL
FROM 
    PRODUTO
ORDER BY 
    NM_PRODUTO ASC;

--LISTAR OS PRODUTOS COM QUANTIDADE EM ESTOQUE MAIOR IGUAL A 30 E MENOR IGUAL A 1O EM ORDEM ALFABÉTICA.
SELECT * FROM PRODUTO WHERE QT_ESTOQUE >= 30 ORDER BY NM_PRODUTO ASC

--QUAL PRODUTO TEM PREÇO MAIOR OU IGUAL QUE 2100?
SELECT NM_PRODUTO
FROM PRODUTO
WHERE VL_PRECO >= 2100;

--PESQUISAR OS PRODUTOS COM PREÇO MAIOR IGUAL A 3000 E MENOR IGUAL A 9000, MAS SOMENTE OS PRODUTOS QUE TÊM ANO DE COMPRA MAIOR QUE 2020. 
SELECT * FROM PRODUTO WHERE VL_PRECO >= 3000 AND VL_PRECO <= 9000 AND YEAR(DT_COMPRA) > 2020;

--QUAIS SÃO O PRODUTOS COM PREÇO IGUAL A 2600, 2100 E 1000 EM ORDEM ALFABÉTICA, USANDO O OPERADOR LÓGICO IN.
SELECT * FROM PRODUTO
WHERE VL_PRECO IN (2600, 2100, 1000)
ORDER BY NM_PRODUTO ASC;

--QUAIS SÃO O PRODUTOS COM PREÇO IGUAL A 2600, 2100 E 1000 EM ORDEM ALFABÉTICA. 
SELECT * FROM PRODUTO
WHERE VL_PRECO IN (2600, 2100, 1000)
ORDER BY NM_PRODUTO ASC;

--PESQUISAR OS DADOS DO PRODUTO: FOGÃO ELETROLUZ 5 BOCAS.
SELECT * FROM PRODUTO
WHERE NM_PRODUTO = 'FOGÃO ELETROLUZ 5 BOCAS';

--QUAL PRODUTO TEM PREÇO MENOR QUE 2100? 
SELECT NM_PRODUTO
FROM PRODUTO
WHERE VL_PRECO < 2100;

--QUAL PRODUTO TEM PREÇO MENOR OU IGUAL QUE 2100?
SELECT NM_PRODUTO
FROM PRODUTO
WHERE VL_PRECO <= 2100;

--LISTAR OS PRODUTOS QUE NÃO TÊM O PREÇO IGUAL A 1000, 2100 E 2600 EM ORDEM DECRESCENTE DE PREÇO.
SELECT * FROM PRODUTO WHERE VL_PRECO NOT IN (1000, 2100, 2600) ORDER BY VL_PRECO DESC

--QUAIS PRODUTOS TÊM PREÇO MAIOR IGUAL A 1990,50 OU QUANTIDADE EM ESTOQUE IGUAL A 13 EM ORDEM DECRESCENTE DE DATA DE COMPRA.
SELECT * FROM PRODUTO WHERE VL_PRECO >= 1990.50 OR QT_ESTOQUE = 13 ORDER BY DT_COMPRA DESC

--QUAIS PRODUTOS TÊM PREÇO MAIOR IGUAL A 1990,50 E QUANTIDADE EM ESTOQUE IGUAL A 13 EM ORDEM DECRESCENTE DE DATA DE COMPRA. 
SELECT * FROM PRODUTO WHERE VL_PRECO >= 1990.50 AND QT_ESTOQUE = 13 ORDER BY DT_COMPRA DESC

--QUAIS PRODUTOS TÊM PREÇO MAIOR QUE 5000 E DATA DE COMPRA MENOR QUE 31/12/2023 EM ORDEM ALFABÉTICA. 
SELECT * FROM PRODUTO
WHERE VL_PRECO > 5000 AND DT_COMPRA < '2023-12-31'
ORDER BY NM_PRODUTO ASC;






